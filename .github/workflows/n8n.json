{
  "name": "My workflow",
  "nodes": [
    {
      "parameters": {
        "jsCode": "let markdwon_list = [];\nconst issues = $input.first().json.data.repository.issues.nodes;\nfor (let i = 0; i < issues.length; i++) {\n  const issue = issues[i];\n  if (!issue.author?.login) continue;\n  const comments_text = issue.comments?.nodes.length ? issue.comments.nodes.map(c => `- ${c.body}`).join('\\n') : \"NA\";\n  const labels_text = issue.labels.edges.length ? issue.labels.edges.map(edge => edge.node.name).join(\",\") : \"NA\";\n  const issue_type = issue.issueType ?? \"NA\";\n  markdwon_list.push(`\n    ## Issue ${i}\n    **Title**: ${issue.title}\n\n    **Type**: ${issue_type}\n\n    **Labels**: ${labels_text}\n\n    **Body**: ${issue.body}\n\n    **Comments**: ${comments_text}\n\n    **URL**: ${issue.url}\n  `)\n}\nreturn {\n  markdown_list: markdwon_list.join('\\n')\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        112,
        1120
      ],
      "id": "99abf255-7f65-4772-8bf1-90cf499a0b65",
      "name": "Convert Markdown"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -560,
        1120
      ],
      "id": "9d915cd3-9077-4308-b9f0-b6fc759c1441",
      "name": "When clicking â€˜Execute workflowâ€™"
    },
    {
      "parameters": {
        "jsCode": "return {\n  owner: \"vercel\",\n  name: \"next.js\"\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -336,
        1120
      ],
      "id": "b0c87ce1-9c4b-4839-888a-334220da5734",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "jsCode": "const YAML = require('yaml');\nfor (const item of $input.all()) {\n  let response = $input.first().json.output;\n  // let response = $input.first().json.candidates[0].content.parts[0].text;\n  let responseText = response\n      .replace(/^(\\n)+/, '')                 // ë§¨ ì•ì˜ \\n ì œê±°\n      .replace(/^yaml/, '')                  // 'yaml' ì ‘ë‘ì–´ ì œê±°\n      .replace(/^```yaml/, '')               // '```yaml' ì ‘ë‘ì–´ ì œê±°\n      .trimEnd()                             // ëì˜ ê³µë°± ì œê±°\n      .replace(/```$/, '');                  // '```' ì ‘ë¯¸ì–´ ì œê±°\n  item.json = YAML.parse(responseText);\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        688,
        1120
      ],
      "id": "e1518ba9-818c-4a1f-877a-f773dad50ee1",
      "name": "parse YAML"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nlet test = [];\nconst issues = $input.first().json.issues;\nfor (const issue of issues) {\n  let issueInfo = `<mj-text font-size=\"22px\">${issue.issueTitle}</mj-text>\n          <mj-spacer></mj-spacer>\n          <mj-text font-size=\"15px\" font-weight=\"bold\">ğŸ§¾ ì´ìŠˆ ë‚´ìš©</mj-text>\n          <mj-text font-size=\"14px\" line-height=\"1.6\">${issue.issueDescription}</mj-text>\n          <mj-text font-size=\"15px\" font-weight=\"bold\">ğŸ§© ì›ì¸</mj-text>\n          <mj-text font-size=\"14px\" line-height=\"1.6\">${issue.rootCause}</mj-text>`;\n  \n  let resolutionApproach = `<mj-text font-size=\"15px\" font-weight=\"bold\">ğŸ› ï¸ í•´ê²° ë°©í–¥</mj-text><mj-text font-size=\"14px\" line-height=\"1.6\">`;\n  let approaches = [] // TODO : ë™ì¼í•œ ë¡œì§ í•¨ìˆ˜ë¡œ ë§Œë“¤ê¸°\n  for (const x of issue.resolutionApproach) {\n    approaches.push(`â€¢ ${x}`);\n  }\n  resolutionApproach += approaches.join('<br/>');\n  resolutionApproach += '</mj-text>';\n  \n  let complianceWithStandards = `<mj-text font-size=\"15px\" font-weight=\"bold\">âœ… ê¸°ì¤€ ì í•©ì„±: ${issue.complianceWithStandards.level}</mj-text><mj-text font-size=\"14px\" line-height=\"1.6\">`\n  let standardReasons = [] \n  for (const reason of issue.complianceWithStandards.reasons) {\n    standardReasons.push(`â€¢ ${reason}`);\n  }\n  complianceWithStandards += standardReasons.join('<br/>');\n  complianceWithStandards += '</mj-text>';\n  \n  let technicalDifficulty = `<mj-text font-size=\"15px\" font-weight=\"bold\">ğŸ§— ê¸°ìˆ ì ì¸ ë‚œì´ë„: ${issue.technicalDifficulty.level}</mj-text><mj-text font-size=\"14px\" line-height=\"1.6\">`\n  let difficultyReason  = []\n  for (const reason of issue.technicalDifficulty.reasons) {\n    difficultyReason.push(`â€¢ ${reason}`);\n  } \n  technicalDifficulty += difficultyReason.join('<br/>');\n  technicalDifficulty += '</mj-text>';\n\n  let issuelink = `<mj-text font-size=\"15px\" font-weight=\"bold\"><p>ğŸ‘‰ ì´ìŠˆ ë³´ëŸ¬ê°€ê¸° <a href=\"${issue.issueURL}\">(ë§í¬)</a></p></mj-text>`;\n  test.push(issueInfo + resolutionApproach + complianceWithStandards + technicalDifficulty + issuelink)\n}\n\nreturn {\n  issueHTML: `\n    <mjml>\n      <mj-body>\n    \n        <mj-section background-color=\"#E9E9E9\">\n      <mj-column>\n\t\t\t\t<mj-divider/>\n        <mj-image src=\"https://lh3.googleusercontent.com/d/11VgJS7_uMNmlBLaiN9S68Nz-QWZIsLV4\" width=\"500\" height=\"150\"/>\n        <mj-divider  border-width=\"2px\"/>\n      </mj-column>\n    </mj-section>\n    \n        <mj-wrapper border=\"1px solid #000000\" padding=\"50px 30px\">\n          <mj-section>\n            <mj-column>\n              ${test.join(`<mj-divider border-width=\"1px\" border-color=\"lightgrey\"></mj-divider>`)}\n            </mj-column>\n          </mj-section>\n        </mj-wrapper>\n      </mj-body>\n    </mjml>\n`\n}\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        912,
        1120
      ],
      "id": "09339ec8-6306-4e73-b945-ac7f98840e26",
      "name": "convert MJML"
    },
    {
      "parameters": {
        "jsCode": "const mjml2html = require('mjml');\n\nreturn {\n  htmlOutput: mjml2html($input.first().json.issueHTML)\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1136,
        1120
      ],
      "id": "78414a49-3a06-4416-b00e-09695a9b4977",
      "name": "convert MJML to HTML"
    },
    {
      "parameters": {
        "fromEmail": "hello@demomailtrap.co",
        "toEmail": "dstdbsgml@gmail.com",
        "subject": "Hello",
        "html": "={{ $json.htmlOutput.html }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-mailtrap.mailtrap",
      "typeVersion": 1,
      "position": [
        1344,
        1120
      ],
      "id": "d2517a65-3774-46de-b012-adbe02539913",
      "name": "Send an email",
      "credentials": {
        "MailtrapTokenApi": {
          "id": "MailtrapTokenApi",
          "name": "Mailtrap Token Api account"
        }
      }
    },
    {
      "parameters": {
        "model": "google/gemini-2.0-flash-exp:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        256,
        1360
      ],
      "id": "5166ae3b-ef00-4bb5-8e9a-cb2608d6588d",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "openRouterApi",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "=define",
        "text": "={{ $json.markdown_list }}\n\n\nGenerate a YAML object that matches the TypeScript type $IssueCollection below:\n(You MUST wrap every YAML list item in double quotes. This rule is STRICT and cannot be violated)\n\ntype Level = \"high\" | \"medium\" | \"low\";\n\ninterface LevelWithReasons {\n  level: Level;\n  reasons: string[];\n}\n\ninterface Issue {\n  issueTitle: string;\n  issueURL: string;\n  issueDescription: string;\n  rootCause: string;\n  resolutionApproach: string[];\n  complianceWithStandards: LevelWithReasons;\n  technicalDifficulty: LevelWithReasons;\n}\n\ninterface IssueCollection {\n  issues: Issue[];\n}\n\n------------\nExample output:\nissues:\n  - issueTitle: |\n      ...\n    issueURL: \"https://example.com\"\n    issueDescription: |\n      ...\n    rootCause: |\n      ...\n    resolutionApproach:\n      - \"...\"\n    complianceWithStandards:\n      level: \"medium\"\n      reasons:\n        - \"...\"\n    technicalDifficulty:\n      level: \"high\"\n      reasons:\n        - \"...\"",
        "needsFallback": true,
        "options": {
          "systemMessage": "=ë„ˆëŠ” ì˜¤í”ˆì†ŒìŠ¤ì— ê¸°ì—¬í•˜ë ¤ëŠ” ì˜¤í”ˆì†ŒìŠ¤ ê¸°ì—¬ ê²½í—˜ì´ ë§ì€ 10ë…„ì°¨ ê°œë°œìì•¼.\n\nì•„ë˜ ì´ìŠˆë“¤ì„ ê²€ìƒ‰í•´ì„œ ë‚´ìš©ì„ ì½ì–´ë³´ê³  ë°‘ì˜ ê¸°ì—¬í•˜ê¸° ì¢‹ì€ ê¸°ì¤€ì— ë§ê²Œ ë¶„ë¥˜í•´ì¤˜.\nì´ìŠˆë“¤ì´ ìˆëŠ” urlì€ https://github.com/{{ $('Code in JavaScript').first().json.repo}}/issues ì´ì•¼.\nì´ìŠˆë¥¼ ë¶„ë¥˜í• ë• ì´ìŠˆ ë‚´ìš©, ì›ì¸, í•´ê²°ë°©í–¥ê³¼ ê¸°ì¤€ì— ì–¼ë§ˆë‚˜ ì˜ ë§ëŠ”ì§€(ìƒ,ì¤‘,í•˜), ê¸°ìˆ ì ì¸ ë‚œì´ë„ (ìƒ,ì¤‘,í•˜) ë¡œ í‰ê°€í•´ì¤˜.\n\n[ê¸°ì—¬í•˜ê¸° ì¢‹ì€ ì´ìŠˆ ê¸°ì¤€]\nì´ìŠˆì˜ ë‚´ìš©ì´ ìƒì„¸í•˜ê²Œ ì˜ ì‘ì„±ë˜ì–´ ìˆëŠ” ê²½ìš° \nì´ìŠˆì˜ ë‚´ìš© ì•ˆì— ë²„ê·¸ë‚˜ ì—ëŸ¬ì˜ ë¡œê·¸ì™€ ì¬í˜„í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ëª…ì‹œë˜ì–´ ìˆëŠ” ê²½ìš° \nì´ìŠˆ ë‚´ì— ì˜ì‹¬ë˜ëŠ” ì†ŒìŠ¤ì½”ë“œì˜ ìœ„ì¹˜ê°€ ì œë³´ìë‚˜ ë©”ì¸í…Œì´ë„ˆì— ì˜í•´ íŠ¹ì •ëœ ê²½ìš° \në©”ì¸í…Œì´ë„ˆê°€ ì´ìŠˆì˜ ë‚´ìš©ì„ í™•ì¸í•˜ê³  ë¬¸ì œê°€ ë§ì•„ì„œ ë°©í–¥ì„ ì •í•´ì£¼ê±°ë‚˜ ê¸°ì—¬ í•´ë‹¬ë¼ê³  í•œ ê²½ìš° \në©”ì¸í…Œì´ë„ˆê°€ ì§ì ‘ ì‘ì„±í•œ ì´ìŠˆ\nì´ìŠˆì˜ ë¼ë²¨ì— good first issue ê°€ ë‹¬ë ¤ìˆê³ , blocked ë‚˜ wait-for-triageê°€ ì—†ëŠ” ì´ìŠˆ \nì´ìŠˆë¥¼ í•´ê²°í•˜ëŠ” PRì´ ì•„ì§ ìƒì„±ë˜ì§€ ì•Šì€ ì´ìŠˆ (ëˆ„êµ°ê°€ê°€ PRì„ ë§Œë“¤ê² ë‹¤ê³ ë§Œ ë§í•˜ê³  PRì´ ì•„ì§ ìƒì„± ì•ˆëœê±´ ìƒê´€ ì—†ìŒ)\n\nìœ„ì˜ ê¸°ì¤€ì— ì˜ ë§ëŠ” ì´ìŠˆì¼ìˆ˜ë¡ ìƒì„¸í•˜ê²Œ ì„¤ëª…í•˜ê³  ê°•ì¡°í•´ì¤˜.\nìœ„ì˜ ê¸°ì¤€ì— ì•ˆë§ëŠ” ì´ìŠˆëŠ” ìš”ì•½í•  í•„ìš” ì—†ì–´.\n\nGenerate a YAML object that matches the TypeScript type $IssueCollection below:\n(You MUST wrap every YAML list item in double quotes. This rule is STRICT and cannot be violated)\n\ntype Level = \"high\" | \"medium\" | \"low\";\n\ninterface LevelWithReasons {\n  level: Level;\n  reasons: string[];\n}\n\ninterface Issue {\n  issueTitle: string;\n  issueURL: string;\n  issueDescription: string;\n  rootCause: string;\n  resolutionApproach: string[];\n  complianceWithStandards: LevelWithReasons;\n  technicalDifficulty: LevelWithReasons;\n}\n\ninterface IssueCollection {\n  issues: Issue[];\n}\n\n------------\nExample output:\nissues:\n  - issueTitle: |\n      ...\n    issueURL: \"https://example.com\"\n    issueDescription: |\n      ...\n    rootCause: |\n      ...\n    resolutionApproach:\n      - \"...\"\n    complianceWithStandards:\n      level: \"medium\"\n      reasons:\n        - \"...\"\n    technicalDifficulty:\n      level: \"high\"\n      reasons:\n        - \"...\"",
          "batching": {
            "delayBetweenBatches": 2
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        336,
        1120
      ],
      "id": "9ca0496b-9938-466b-b159-164f72a2bc24",
      "name": "AI Agent",
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": "qwen/qwen3-coder:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        368,
        1360
      ],
      "id": "15339e92-4499-477d-97f8-8e146ef207a1",
      "name": "OpenRouter Chat Fallback Model",
      "credentials": {
        "openRouterApi": {
          "id": "openRouterApi",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "headerAuth",
        "endpoint": "https://api.github.com/graphql",
        "query": "=query {\n  repository(owner: \"{{ $json.owner }}\", name: \"{{ $json.name }}\") {\n    issues(\n      first: 10\n      states: OPEN\n      labels: [\"Module Resolution\"]\n      orderBy: { field: CREATED_AT, direction: DESC }\n    ) {\n      nodes {\n        title\n        url\n        body\n        author {\n          ... on User {\n            login\n          }\n        }\n        issueType {\n          name\n        }\n        labels(first: 5) {\n          edges {\n            node {\n              name\n            }\n          }\n        }\n        comments(first: 10) {\n          nodes {\n            body\n          }\n        }\n      }\n    }\n  }\n}\n",
        "variables": "="
      },
      "type": "n8n-nodes-base.graphql",
      "typeVersion": 1.1,
      "position": [
        -112,
        1120
      ],
      "id": "04c3ca7a-fa69-45d7-9cd4-6e28e85842e1",
      "name": "GraphQL",
      "credentials": {
        "httpHeaderAuth": {
          "id": "httpHeaderAuth",
          "name": "Header Auth account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Convert Markdown": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking â€˜Execute workflowâ€™": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "GraphQL",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "parse YAML": {
      "main": [
        [
          {
            "node": "convert MJML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "convert MJML": {
      "main": [
        [
          {
            "node": "convert MJML to HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "convert MJML to HTML": {
      "main": [
        [
          {
            "node": "Send an email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "parse YAML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Fallback Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "GraphQL": {
      "main": [
        [
          {
            "node": "Convert Markdown",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "7d3cfdfb-612b-45a5-8d7e-ff981bfd3a84",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "c4eb748d1201f6efcf3fb4abe55ad9f6c4623960d681ba4f9bd76fc5b7ea8d40"
  },
  "tags": []
}
