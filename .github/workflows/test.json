{
  "name": "My workflow",
  "nodes": [
    {
      "parameters": {
        "batchSize": "={{ 1 }}",
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        224,
        672
      ],
      "id": "6265745c-fd1f-41f3-be59-a45234b1e27e",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "jsCode": "return $input.all().filter(\n  item => !(\n    item.json.pull_request ||\n    item.json.user.type === \"Bot\" || \n    /bot$/i.test(item.json.user.login)\n  )\n)"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -32,
        672
      ],
      "id": "5e20b7c0-24a9-4fd5-8bf5-09404aa189d2",
      "name": "Filter Issue"
    },
    {
      "parameters": {
        "jsCode": "var issue = $('Loop Over Items').first().json;\nvar comments = [];\nfor (const item of $input.all()) {\n  if (\n    Object.keys(item.json).length === 0 ||\n    item.json.user?.type === \"Bot\" ||  \n    /\\[bot\\]$/i.test(item.json.user?.login)\n  ) continue;\n  comments.push(`${item.json.user.login}: ${item.json.body}`)\n}\nreturn {\n    \"title\": issue.title,\n    \"body\": issue.body.slice(0, 500),\n    \"url\": issue.html_url,\n    \"comments\": comments,\n    \"labels\": issue.labels?.map(label => label.name) ?? [],\n    \"type\": issue.type?.name ?? ''\n  };"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        560,
        1072
      ],
      "id": "2b9dab4b-5010-4ebd-961e-6b609dd05200",
      "name": "Exclude Bot Comment",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "url": "=https://api.github.com/repos/{{ $json.repo }}/issues",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "page",
              "value": "1"
            },
            {
              "name": "per_page",
              "value": "15"
            },
            {
              "name": "state",
              "value": "open"
            },
            {
              "name": "sort",
              "value": "created"
            },
            {
              "name": "direction",
              "value": "desc"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/vnd.github+json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -224,
        672
      ],
      "id": "1073173e-7da9-4831-99f5-bdf04e9d38bb",
      "name": "HTTP Request (Issue)"
    },
    {
      "parameters": {
        "url": "={{ $json.comments_url }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/vnd.github+json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        336,
        1024
      ],
      "id": "085f97f2-e2ca-41ff-9702-3f222edd8b40",
      "name": "HTTP Request (Comment)",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nlet markdwon_list = [];\nfor (let i = 0; i < $input.all().length; i++) {\n  const issue = $input.all()[i].json;\n  const comments_text = issue.comments?.length ? issue.comments.map(c => `- ${c}`).join('\\n') : \"ëŒ“ê¸€ ì—†ìŒ\";\n  const labels_text = issue.labels ?? \"ë¼ë²¨ ì—†ìŒ\";\n  const issue_type = issue.type ?? \"íƒ€ì… ì—†ìŒ\";\n  markdwon_list.push(`\n    ## Issue ${i}\n    **Title**: ${issue.title}\n\n    **Type**: ${issue_type}\n\n    **Labels**: ${labels_text}\n\n    **Body**: ${issue.body}\n\n    **Comments**: ${comments_text}\n\n    **URL**: ${issue.url}\n  `)\n}\nreturn {\n  markdown_list: markdwon_list.join('\\n')\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        432,
        576
      ],
      "id": "99abf255-7f65-4772-8bf1-90cf499a0b65",
      "name": "Convert Markdown"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -624,
        672
      ],
      "id": "9d915cd3-9077-4308-b9f0-b6fc759c1441",
      "name": "When clicking â€˜Execute workflowâ€™"
    },
    {
      "parameters": {
        "jsCode": "return {\n  repo: \"vercel/next.js\"\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -416,
        672
      ],
      "id": "b0c87ce1-9c4b-4839-888a-334220da5734",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "jsCode": "const YAML = require('yaml');\nfor (const item of $input.all()) {\n  let response = $input.first().json.output;\n  // let response = $input.first().json.candidates[0].content.parts[0].text;\n  let responseText = response\n      .replace(/^(\\n)+/, '')                 // ë§¨ ì•ì˜ \\n ì œê±°\n      .replace(/^yaml/, '')                  // 'yaml' ì ‘ë‘ì–´ ì œê±°\n      .replace(/^```yaml/, '')               // '```yaml' ì ‘ë‘ì–´ ì œê±°\n      .trimEnd()                             // ëì˜ ê³µë°± ì œê±°\n      .replace(/```$/, '');                  // '```' ì ‘ë¯¸ì–´ ì œê±°\n  item.json = YAML.parse(responseText);\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        992,
        576
      ],
      "id": "e1518ba9-818c-4a1f-877a-f773dad50ee1",
      "name": "parse YAML"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nlet test = [];\nconst issues = $input.first().json.issues;\nfor (const issue of issues) {\n  let issueInfo = `<mj-text font-size=\"22px\">${issue.issueTitle}</mj-text>\n          <mj-spacer></mj-spacer>\n          <mj-text font-size=\"15px\" font-weight=\"bold\">ğŸ§¾ ì´ìŠˆ ë‚´ìš©</mj-text>\n          <mj-text font-size=\"14px\" line-height=\"1.6\">${issue.issueDescription}</mj-text>\n          <mj-text font-size=\"15px\" font-weight=\"bold\">ğŸ§© ì›ì¸</mj-text>\n          <mj-text font-size=\"14px\" line-height=\"1.6\">${issue.rootCause}</mj-text>`;\n  \n  let resolutionApproach = `<mj-text font-size=\"15px\" font-weight=\"bold\">ğŸ› ï¸ í•´ê²° ë°©í–¥</mj-text><mj-text font-size=\"14px\" line-height=\"1.6\">`;\n  let approaches = [] // TODO : ë™ì¼í•œ ë¡œì§ í•¨ìˆ˜ë¡œ ë§Œë“¤ê¸°\n  for (const x of issue.resolutionApproach) {\n    approaches.push(`â€¢ ${x}`);\n  }\n  resolutionApproach += approaches.join('<br/>');\n  resolutionApproach += '</mj-text>';\n  \n  let complianceWithStandards = `<mj-text font-size=\"15px\" font-weight=\"bold\">âœ… ê¸°ì¤€ ì í•©ì„±: ${issue.complianceWithStandards.level}</mj-text><mj-text font-size=\"14px\" line-height=\"1.6\">`\n  let standardReasons = [] \n  for (const reason of issue.complianceWithStandards.reasons) {\n    standardReasons.push(`â€¢ ${reason}`);\n  }\n  complianceWithStandards += standardReasons.join('<br/>');\n  complianceWithStandards += '</mj-text>';\n  \n  let technicalDifficulty = `<mj-text font-size=\"15px\" font-weight=\"bold\">ğŸ§— ê¸°ìˆ ì ì¸ ë‚œì´ë„: ${issue.technicalDifficulty.level}</mj-text><mj-text font-size=\"14px\" line-height=\"1.6\">`\n  let difficultyReason  = []\n  for (const reason of issue.technicalDifficulty.reasons) {\n    difficultyReason.push(`â€¢ ${reason}`);\n  } \n  technicalDifficulty += difficultyReason.join('<br/>');\n  technicalDifficulty += '</mj-text>';\n  \n  test.push(issueInfo + resolutionApproach + complianceWithStandards + technicalDifficulty)\n}\n\nreturn {\n  issueHTML: `\n    <mjml>\n      <mj-body>\n    \n        <mj-section background-color=\"#E9E9E9\">\n      <mj-column>\n\t\t\t\t<mj-divider/>\n        <mj-image src=\"https://lh3.googleusercontent.com/d/11VgJS7_uMNmlBLaiN9S68Nz-QWZIsLV4\" width=\"500\" height=\"150\"/>\n        <mj-divider  border-width=\"2px\"/>\n      </mj-column>\n    </mj-section>\n    \n        <mj-wrapper border=\"1px solid #000000\" padding=\"50px 30px\">\n          <mj-section>\n            <mj-column>\n              ${test.join(`<mj-divider border-width=\"1px\" border-color=\"lightgrey\"></mj-divider>`)}\n            </mj-column>\n          </mj-section>\n        </mj-wrapper>\n      </mj-body>\n    </mjml>\n`\n}\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1216,
        576
      ],
      "id": "09339ec8-6306-4e73-b945-ac7f98840e26",
      "name": "convert MJML"
    },
    {
      "parameters": {
        "jsCode": "const mjml2html = require('mjml');\n\nreturn {\n  htmlOutput: mjml2html($input.first().json.issueHTML)\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1456,
        576
      ],
      "id": "78414a49-3a06-4416-b00e-09695a9b4977",
      "name": "convert MJML to HTML"
    },
    {
      "parameters": {
        "fromEmail": "hello@demomailtrap.co",
        "toEmail": "dstdbsgml@gmail.com",
        "subject": "Hello",
        "html": "={{ $json.htmlOutput.html }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-mailtrap.mailtrap",
      "typeVersion": 1,
      "position": [
        1680,
        576
      ],
      "id": "d2517a65-3774-46de-b012-adbe02539913",
      "name": "Send an email",
      "credentials": {
        "MailtrapTokenApi": {
          "id": "MailtrapTokenApi",
          "name": "Mailtrap Token account"
        }
      }
    },
    {
      "parameters": {
        "model": "google/gemini-2.0-flash-exp:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        528,
        880
      ],
      "id": "5166ae3b-ef00-4bb5-8e9a-cb2608d6588d",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "openRouterApi",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.markdown_list }}\n\nGenerate a YAML object that matches the TypeScript type $IssueCollection below:\nEach YAML output MUST be after a newline, indented, with block scalar indicator ('|').\n\ntype Level = \"high\" | \"medium\" | \"low\";\n\ninterface LevelWithReasons {\n  level: Level;\n  reasons: string[];\n}\n\ninterface Issue {\n  issueTitle: string;\n  issueDescription: string;\n  rootCause: string;\n  resolutionApproach: string[];\n  complianceWithStandards: LevelWithReasons;\n  technicalDifficulty: LevelWithReasons;\n}\n\ninterface IssueCollection {\n  issues: Issue[];\n}\n\n------------\nExample output:\nissues:\n  - issueTitle: |\n      ...\n    issueDescription: |\n      ...\n    rootCause: |\n      ...\n    resolutionApproach: |\n      ...\n    complianceWithStandards:\n      level: \"medium\"\n      reasons: |\n        ...\n    technicalDifficulty:\n      level: \"high\"\n      reasons: |\n        ...",
        "needsFallback": true,
        "options": {
          "systemMessage": "=ë„ˆëŠ” ì˜¤í”ˆì†ŒìŠ¤ì— ê¸°ì—¬í•˜ë ¤ëŠ” ì˜¤í”ˆì†ŒìŠ¤ ê¸°ì—¬ ê²½í—˜ì´ ë§ì€ 10ë…„ì°¨ ê°œë°œìì•¼.\n\nì•„ë˜ ì´ìŠˆë“¤ì„ ê²€ìƒ‰í•´ì„œ ë‚´ìš©ì„ ì½ì–´ë³´ê³  ë°‘ì˜ ê¸°ì—¬í•˜ê¸° ì¢‹ì€ ê¸°ì¤€ì— ë§ê²Œ ë¶„ë¥˜í•´ì¤˜.\nì´ìŠˆë“¤ì´ ìˆëŠ” urlì€ https://github.com/{{ $('Code in JavaScript').first().json.repo}}/issues ì´ì•¼.\nì´ìŠˆë¥¼ ë¶„ë¥˜í• ë• ì´ìŠˆ ë‚´ìš©, ì›ì¸, í•´ê²°ë°©í–¥ê³¼ ê¸°ì¤€ì— ì–¼ë§ˆë‚˜ ì˜ ë§ëŠ”ì§€(ìƒ,ì¤‘,í•˜), ê¸°ìˆ ì ì¸ ë‚œì´ë„ (ìƒ,ì¤‘,í•˜) ë¡œ í‰ê°€í•´ì¤˜.\n\n[ê¸°ì—¬í•˜ê¸° ì¢‹ì€ ì´ìŠˆ ê¸°ì¤€]\nì´ìŠˆì˜ ë‚´ìš©ì´ ìƒì„¸í•˜ê²Œ ì˜ ì‘ì„±ë˜ì–´ ìˆëŠ” ê²½ìš° \nì´ìŠˆì˜ ë‚´ìš© ì•ˆì— ë²„ê·¸ë‚˜ ì—ëŸ¬ì˜ ë¡œê·¸ì™€ ì¬í˜„í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ëª…ì‹œë˜ì–´ ìˆëŠ” ê²½ìš° \nì´ìŠˆ ë‚´ì— ì˜ì‹¬ë˜ëŠ” ì†ŒìŠ¤ì½”ë“œì˜ ìœ„ì¹˜ê°€ ì œë³´ìë‚˜ ë©”ì¸í…Œì´ë„ˆì— ì˜í•´ íŠ¹ì •ëœ ê²½ìš° \në©”ì¸í…Œì´ë„ˆê°€ ì´ìŠˆì˜ ë‚´ìš©ì„ í™•ì¸í•˜ê³  ë¬¸ì œê°€ ë§ì•„ì„œ ë°©í–¥ì„ ì •í•´ì£¼ê±°ë‚˜ ê¸°ì—¬ í•´ë‹¬ë¼ê³  í•œ ê²½ìš° \në©”ì¸í…Œì´ë„ˆê°€ ì§ì ‘ ì‘ì„±í•œ ì´ìŠˆ\nì´ìŠˆì˜ ë¼ë²¨ì— good first issue ê°€ ë‹¬ë ¤ìˆê³ , blocked ë‚˜ wait-for-triageê°€ ì—†ëŠ” ì´ìŠˆ \nì´ìŠˆë¥¼ í•´ê²°í•˜ëŠ” PRì´ ì•„ì§ ìƒì„±ë˜ì§€ ì•Šì€ ì´ìŠˆ (ëˆ„êµ°ê°€ê°€ PRì„ ë§Œë“¤ê² ë‹¤ê³ ë§Œ ë§í•˜ê³  PRì´ ì•„ì§ ìƒì„± ì•ˆëœê±´ ìƒê´€ ì—†ìŒ)\n\nìœ„ì˜ ê¸°ì¤€ì— ì˜ ë§ëŠ” ì´ìŠˆì¼ìˆ˜ë¡ ìƒì„¸í•˜ê²Œ ì„¤ëª…í•˜ê³  ê°•ì¡°í•´ì¤˜.\nìœ„ì˜ ê¸°ì¤€ì— ì•ˆë§ëŠ” ì´ìŠˆëŠ” ìš”ì•½í•  í•„ìš” ì—†ì–´.\n\nGenerate a YAML object that matches the TypeScript type $IssueCollection below:\nEach YAML output MUST be after a newline, indented, with block scalar indicator ('|').\n\ntype Level = \"high\" | \"medium\" | \"low\";\n\ninterface LevelWithReasons {\n  level: Level;\n  reasons: string[];\n}\n\ninterface Issue {\n  issueTitle: string;\n  issueDescription: string;\n  rootCause: string;\n  resolutionApproach: string[];\n  complianceWithStandards: LevelWithReasons;\n  technicalDifficulty: LevelWithReasons;\n}\n\ninterface IssueCollection {\n  issues: Issue[];\n}\n\n------------\nExample output:\nissues:\n  - issueTitle: |\n      ...\n    issueDescription: |\n      ...\n    rootCause: |\n      ...\n    resolutionApproach: |\n      ...\n    complianceWithStandards:\n      level: \"medium\"\n      reasons: |\n        ...\n    technicalDifficulty:\n      level: \"high\"\n      reasons: |\n        ...",
          "batching": {
            "delayBetweenBatches": 2
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        640,
        656
      ],
      "id": "9ca0496b-9938-466b-b159-164f72a2bc24",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": "qwen/qwen3-coder:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        672,
        880
      ],
      "id": "15339e92-4499-477d-97f8-8e146ef207a1",
      "name": "OpenRouter Chat Fallback Model",
      "credentials": {
        "openRouterApi": {
          "id": "openRouterApi",
          "name": "OpenRouter account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Convert Markdown",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request (Comment)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter Issue": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Exclude Bot Comment": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request (Issue)": {
      "main": [
        [
          {
            "node": "Filter Issue",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request (Comment)": {
      "main": [
        [
          {
            "node": "Exclude Bot Comment",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Markdown": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking â€˜Execute workflowâ€™": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "HTTP Request (Issue)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "parse YAML": {
      "main": [
        [
          {
            "node": "convert MJML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "convert MJML": {
      "main": [
        [
          {
            "node": "convert MJML to HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "convert MJML to HTML": {
      "main": [
        [
          {
            "node": "Send an email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "parse YAML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Fallback Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "62cc40bc-cf12-4133-ba6d-6e924ad8f208",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "c4eb748d1201f6efcf3fb4abe55ad9f6c4623960d681ba4f9bd76fc5b7ea8d40"
  },
  "tags": []
}
